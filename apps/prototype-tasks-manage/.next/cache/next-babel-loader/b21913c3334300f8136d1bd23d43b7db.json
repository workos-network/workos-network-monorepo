{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n/* --- Global --- */\nimport React, { useReducer } from \"react\";\nimport withMonday from \"../withContext\";\nimport { ITEMS_QUERY } from \"../lib/graphql\";\nexport const ITEMS_QUERY_REQUEST = \"ITEMS_QUERY_REQUEST\";\nexport const ITEMS_QUERY_SUCCESS = \"ITEMS_QUERY_SUCCESS\";\nexport const ITEMS_QUERY_FAILURE = \"ITEMS_QUERY_FAILURE\";\n/**\n * @name useItemsQuery\n * @param {Integer} limit\n * @param {Integer} page\n */\n\nexport const useItemsQuery = ({\n  limit,\n  page\n}) => {\n  const monday = withMonday();\n  const [, Set] = React.useState();\n  const initialState = {\n    data: undefined,\n    error: undefined,\n    loading: false\n  };\n\n  function reducer(state, action) {\n    switch (action.type) {\n      case ITEMS_QUERY_REQUEST:\n        return _objectSpread(_objectSpread({}, state), {}, {\n          loading: true\n        });\n\n      case ITEMS_QUERY_SUCCESS:\n        return _objectSpread(_objectSpread({}, state), action.payload);\n\n      case ITEMS_QUERY_FAILURE:\n        return _objectSpread(_objectSpread({}, state), {}, {\n          error: action.payload\n        });\n\n      default:\n        throw new Error();\n    }\n  }\n\n  const {\n    0: state,\n    1: dispatch\n  } = useReducer(reducer, initialState);\n  /* ------------------- */\n  // Actions\n\n  /* ------------------- */\n\n  React.useEffect(inputs => {\n    if (state.loading) {\n      console.log(\"requesting\");\n\n      if (monday.client && monday.isClientAuthorized) {\n        monday.client.request({\n          query: ITEMS_QUERY,\n          variables: {\n            limit: 35 // page: inputs.page\n\n          }\n        }).then(({\n          data,\n          error\n        }) => {\n          dispatch({\n            type: ITEMS_QUERY_SUCCESS,\n            payload: {\n              data: data.items,\n              error\n            }\n          });\n        }).catch(({\n          data,\n          error\n        }) => {\n          console.log(data, error, \"data, error\");\n          dispatch({\n            type: ITEMS_QUERY_FAILURE,\n            payload: error\n          });\n        });\n      }\n    }\n  }, [state.loading, monday.client, monday.isClientAuthorized]);\n\n  const request = inputs => dispatch({\n    type: ITEMS_QUERY_REQUEST,\n    payload: inputs\n  }); // const { loading, error, data, refetch, subscribeToMore } = useQuery(\n  //   ITEMS_QUERY,\n  //   {\n  //     variables: {\n  //       limit: 30,\n  //       page: 1\n  //     }\n  //   }\n  // );\n\n\n  return {\n    request,\n    data: state.data,\n    loading: state.loading,\n    error: state.error,\n    refetch: request\n  };\n};\nexport default useItemsQuery;","map":null,"metadata":{},"sourceType":"module"}