{"ast":null,"code":"import _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _s = $RefreshSig$();\n\n/* --- Global --- */\nimport React from \"react\";\nimport { useQuery } from \"react-apollo\";\n/* --- Local --- */\n\nimport { boardsQuery, CONVERSATION_CREATED } from \"../lib/graphql/queries\";\n/**\n * @name useMondayBoardsQuery\n * @param {Object} filters\n * @param {Integer} limit\n * @param {Function} children\n */\n\nexport var useMondayBoardsQuery = function useMondayBoardsQuery(_ref) {\n  _s();\n\n  var limit = _ref.limit,\n      page = _ref.page;\n\n  var _React$useState = React.useState([]),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      parsed = _React$useState2[0],\n      setParsed = _React$useState2[1];\n\n  var _React$useState3 = React.useState(),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      subscription = _React$useState4[0],\n      setSubscription = _React$useState4[1];\n\n  var _useQuery = useQuery(boardsQuery, {\n    variables: {\n      limit: 10,\n      page: page\n    }\n  }),\n      loading = _useQuery.loading,\n      error = _useQuery.error,\n      data = _useQuery.data,\n      refetch = _useQuery.refetch,\n      subscribeToMore = _useQuery.subscribeToMore;\n\n  var concat = function concat(list, input) {\n    return list.concat(input);\n  };\n\n  React.useEffect(function () {\n    if (subscription) {\n      setSubscription(undefined);\n      setParsed(concat(parsed, subscription));\n    }\n  }, [subscription]);\n  React.useEffect(function () {\n    subscribeToMore({\n      document: CONVERSATION_CREATED,\n      updateQuery: function updateQuery(previousResult, _ref2) {\n        var subscriptionData = _ref2.subscriptionData,\n            rest = _objectWithoutProperties(_ref2, [\"subscriptionData\"]);\n\n        console.log(subscriptionData, \"subscriptionData\");\n\n        if (!subscriptionData.data) {\n          return previousResult;\n        }\n\n        var eventCreated = subscriptionData.data.eventCreated;\n\n        if (eventCreated.event) {\n          setSubscription(eventCreated.event);\n        }\n      }\n    });\n  }, [subscribeToMore]);\n  React.useMemo(function () {\n    if (data && Array.isArray(data.eventList)) {\n      var l = data.eventList.map(function (d) {\n        var i = {};\n        Object.keys(d).forEach(function (k) {\n          if (k === \"event_abi\" || k === \"raw_event\" || k === \"json_event\") {\n            i[k] = JSON.parse(d[k]);\n          } else {\n            i[k] = d[k];\n          }\n        });\n        return i;\n      });\n      setParsed(l);\n    }\n  }, [data]);\n  return {\n    data: data,\n    parsed: parsed,\n    loading: loading,\n    error: error,\n    refetch: refetch\n  };\n};\n\n_s(useMondayBoardsQuery, \"CbAtBStN9xAY+weXXi/Qz8Saso4=\", false, function () {\n  return [useQuery];\n});\n\nexport default useMondayBoardsQuery;","map":{"version":3,"sources":["/Users/admin/Documents/GitHub/esence/workos-network-monorepo/node_modules/react-monday/src/hooks/useMondayBoardsQuery.js"],"names":["React","useQuery","boardsQuery","CONVERSATION_CREATED","useMondayBoardsQuery","limit","page","useState","parsed","setParsed","subscription","setSubscription","variables","loading","error","data","refetch","subscribeToMore","concat","list","input","useEffect","undefined","document","updateQuery","previousResult","subscriptionData","rest","console","log","eventCreated","event","useMemo","Array","isArray","eventList","l","map","d","i","Object","keys","forEach","k","JSON","parse"],"mappings":"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","sourcesContent":["/* --- Global --- */\nimport React from \"react\";\nimport { useQuery } from \"react-apollo\";\n\n/* --- Local --- */\nimport { boardsQuery, CONVERSATION_CREATED } from \"../lib/graphql/queries\";\n\n/**\n * @name useMondayBoardsQuery\n * @param {Object} filters\n * @param {Integer} limit\n * @param {Function} children\n */\nexport const useMondayBoardsQuery = ({ limit, page }) => {\n  const [parsed, setParsed] = React.useState([]);\n  const [subscription, setSubscription] = React.useState();\n  const { loading, error, data, refetch, subscribeToMore } = useQuery(\n    boardsQuery,\n    {\n      variables: {\n        limit: 10,\n        page,\n      },\n    }\n  );\n\n  const concat = (list, input) => {\n    return list.concat(input);\n  };\n  React.useEffect(() => {\n    if (subscription) {\n      setSubscription(undefined);\n      setParsed(concat(parsed, subscription));\n    }\n  }, [subscription]);\n\n  React.useEffect(() => {\n    subscribeToMore({\n      document: CONVERSATION_CREATED,\n      updateQuery: (previousResult, { subscriptionData, ...rest }) => {\n        console.log(subscriptionData, \"subscriptionData\");\n        if (!subscriptionData.data) {\n          return previousResult;\n        }\n        const { eventCreated } = subscriptionData.data;\n        if (eventCreated.event) {\n          setSubscription(eventCreated.event);\n        }\n      },\n    });\n  }, [subscribeToMore]);\n\n  React.useMemo(() => {\n    if (data && Array.isArray(data.eventList)) {\n      const l = data.eventList.map((d) => {\n        let i = {};\n        Object.keys(d).forEach((k) => {\n          if (k === \"event_abi\" || k === \"raw_event\" || k === \"json_event\") {\n            i[k] = JSON.parse(d[k]);\n          } else {\n            i[k] = d[k];\n          }\n        });\n        return i;\n      });\n      setParsed(l);\n    }\n  }, [data]);\n\n  return {\n    data,\n    parsed,\n    loading,\n    error,\n    refetch,\n  };\n};\n\nexport default useMondayBoardsQuery;\n"]},"metadata":{},"sourceType":"module"}